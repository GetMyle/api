<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>MYLE API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #f8f8f2;
  background-color: #272822;
}
.highlight .err {
  color: #151515;
  background-color: #ac4142;
}
.highlight .c, .highlight .cd, .highlight .cm, .highlight .c1, .highlight .cs {
  color: #505050;
}
.highlight .cp {
  color: #f4bf75;
}
.highlight .nt {
  color: #f4bf75;
}
.highlight .o, .highlight .ow {
  color: #d0d0d0;
}
.highlight .p, .highlight .pi {
  color: #d0d0d0;
}
.highlight .gi {
  color: #90a959;
}
.highlight .gd {
  color: #ac4142;
}
.highlight .gh {
  color: #6a9fb5;
  background-color: #151515;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #aa759f;
}
.highlight .kc {
  color: #d28445;
}
.highlight .kt {
  color: #d28445;
}
.highlight .kd {
  color: #d28445;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #90a959;
}
.highlight .sr {
  color: #75b5aa;
}
.highlight .si {
  color: #8f5536;
}
.highlight .se {
  color: #8f5536;
}
.highlight .nn {
  color: #f4bf75;
}
.highlight .nc {
  color: #f4bf75;
}
.highlight .no {
  color: #f4bf75;
}
.highlight .na {
  color: #6a9fb5;
}
.highlight .m, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mb, .highlight .mx {
  color: #90a959;
}
.highlight .ss {
  color: #90a959;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;javascript&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="lang-selector">
              <a href="#" data-language-name="javascript">javascript</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='#'>Sign Up for a Developer Key</a></li>
            <li><a href='https://github.com/tripit/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        
          <h1 id="introduction">Introduction</h1>

<p>The MYLE API uses HTTP methods and a RESTful endpoint structure. The API authorization framework is <a href="https://github.com/hueniverse/oz">Oz</a>. You format requests in JSON and the APIs return JSON-formatted responses.</p>

<h2 id="api-hosts">API hosts</h2>

<p>There are two API hosts:</p>

<ol>
<li><code class="prettyprint">https://api.getmyle.com</code> - production API server</li>
<li><code class="prettyprint">https://dev.getmyle.com:444</code> - development sandbox</li>
</ol>

          <h1 id="mylet">Mylet</h1>

<h2 id="integration-points">Integration points</h2>

<p>In order to integrate with MYLE, a mylet exposes two URLs:</p>

<ol>
<li>UI URL - to present a mylet to a user</li>
<li>Hook URL - to notify a mylet about an event on MYLE side</li>
</ol>

<h2 id="ui-url">UI URL</h2>

<blockquote>
<p>Example of mylet UI URL</p>
</blockquote>
<pre class="highlight plaintext"><code>https://mymylet.example.com/ui?session=&lt;SESSION&gt;
</code></pre>

<p>Every time a user taps on your mylet to open it up, MYLE calls the mylet&rsquo;s UI URL with <a href="#session-token">a session query parameter</a> attached.</p>

<p>It is a good idea on the mylet&rsquo;s backend to call<a href="#get-user-ticket"><code class="prettyprint">/v1/ticket</code> endpoint</a> right away to get <a href="#user-ticket">a user ticket</a>. That also ensures that the call was initiated by MYLE backend.</p>

<p>The following query parameters are specified by MYLE:</p>

<ol>
<li><code class="prettyprint">session</code> - <a href="#session-token">session token</a></li>
<li><code class="prettyprint">sandbox</code> - is specified when a mylet is executed in sandbox environment. Depending on that you do requests to <a href="#api-hosts">production or sandbox API servers</a>.</li>
</ol>

<h2 id="hook-url">Hook URL</h2>

<blockquote>
<p>Example of mylet hook URL</p>
</blockquote>
<pre class="highlight plaintext"><code>https://mymylet.example.com/hook?session=&lt;SESSION&gt;
</code></pre>

<blockquote>
<p>Example of hook body</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"record.associated"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"record"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3400</span><span class="p">,</span><span class="w">
    </span><span class="nt">"raw"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Go to meeting tomorrow at 5 PM"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"phrase"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Go to meeting tomorrow at 5 PM"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-11-09T07:23:48.000Z"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"timezoneOffset"</span><span class="p">:</span><span class="w"> </span><span class="mi">-420</span><span class="p">,</span><span class="w">
    </span><span class="nt">"location"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"longitude"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"latitude"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"altitude"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"language"</span><span class="p">:</span><span class="w"> </span><span class="s2">"eng-USA"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"mylet"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mymylet"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"rdns"</span><span class="p">:</span><span class="w"> </span><span class="s2">"com.example.mymylet"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My Mylet"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"keywords"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"eng-USA"</span><span class="p">:</span><span class="w"> </span><span class="s2">"book"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0.1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"build"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Every time there is an event related to a mylet, MYLE calls the mylet&rsquo;s hook URL with <a href="#session-token">a session query parameter</a> attached and a body representing the event.</p>

<p>It is a good idea on the mylet&rsquo;s backend to call <a href="#get-user-ticket"><code class="prettyprint">/v1/ticket</code> endpoint</a> right away to get <a href="#user-ticket">a user ticket</a>. That also ensures that the call was initiated by MYLE backend.</p>

<h3 id="hook-event-types">Hook event types</h3>

<table><thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>record.associated</td>
<td>A record was associated with a mylet (whether by a keyphrase or manually by a user)</td>
</tr>
</tbody></table>

          <h1 id="authentication">Authentication</h1>

<blockquote>
<p>Example of a mylet URL request</p>
</blockquote>
<pre class="highlight plaintext"><code>https://mymylet.example.com/ui?session=&lt;SESSION&gt;
</code></pre>

<p>There are two cases when your mylet execution is triggered by MYLE:</p>

<ol>
<li>A user navigates to the mylet&rsquo;s URL</li>
<li>An event happens related to the mylet, so mylet&rsquo;s hook URL is requested</li>
</ol>

<p>Both of these cases have a <code class="prettyprint">session</code> query parameter supplied. Your mylet exchanges the <a href="#session-token">session token</a> for a <a href="#user-ticket">user ticket</a> and uses the latter to access user&rsquo;s data.</p>

<h2 id="session-token">Session token</h2>

<p>Both UI and hook mylet URLs are supplied with a <code class="prettyprint">session</code> query parameter. The session token is valid for an hour and is exchanged for a <a href="#user-ticket">user ticket</a>.</p>

<p>The exchange is done using <a href="#get-user-ticket"><code class="prettyprint">/v1/ticket</code> endpoint</a> and pursues two goals:</p>

<ol>
<li>To make sure that a mylet request is triggered by MYLE</li>
<li>To generate a <a href="#user-ticket">user ticket</a> that is used to authenticate subsequent MYLE API calls</li>
</ol>

<p>A session token is converted into a <a href="#user-ticket">user ticket</a>.</p>

<h2 id="user-ticket">User ticket</h2>

<blockquote>
<p>Example of a user ticket</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"exp"</span><span class="p">:</span><span class="w"> </span><span class="mi">1478832837390</span><span class="p">,</span><span class="w">
    </span><span class="nt">"app"</span><span class="p">:</span><span class="w"> </span><span class="s2">"com.example.mymylet"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"scope"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"mylet"</span><span class="p">],</span><span class="w">
    </span><span class="nt">"grant"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
    </span><span class="nt">"user"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-6b18XP5TDwlp9RxOhfZv4-5Zvm1n_LQ"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"algorithm"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sha256"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"ext"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"dbs"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2e2ed05a-4f63-4850-9297-5b8384397dd0"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;A TICKET IDENTIFIER&gt;"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>In order to be able to request user&rsquo;s data you first have to receive <a href="https://github.com/hueniverse/oz#ticket-response">a user ticket</a> based on a <a href="#session-token">session token</a> and mylet credentials. <a href="#get-user-ticket"><code class="prettyprint">/v1/ticket</code></a> endpoint is used for that.</p>

<p>Generated user ticket is valid for an hour and at any time can be exchanged for a new one using <a href="#refresh-user-ticket"><code class="prettyprint">/v1/ticket/refresh</code></a> endpoint. You can check its <code class="prettyprint">exp</code> property for expiration (that is time in milliseconds since <code class="prettyprint">1970-01-01</code>).</p>

<p>A user ticket is used to generate a request <a href="#authorization-header"><code class="prettyprint">Authorization</code> header</a>.</p>

<h2 id="authorization-header">Authorization header</h2>
<pre class="highlight javascript"><code><span class="kr">const</span> <span class="nx">Hawk</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'hawk'</span><span class="p">);</span>

<span class="c1">// example mylet credentials</span>
<span class="kr">const</span> <span class="nx">myletCred</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"id"</span><span class="p">:</span> <span class="s2">"com.example.mymylet"</span><span class="p">,</span>
    <span class="s2">"key"</span><span class="p">:</span> <span class="s2">"DacoNO/pKaigvMJqzh86vX71j7y6cwAl"</span><span class="p">,</span>
    <span class="s2">"algorithm"</span><span class="p">:</span> <span class="s2">"sha256"</span>
<span class="p">};</span>

<span class="c1">// function that calculates Hawk authorization header</span>
<span class="kd">function</span> <span class="nx">getHawkHeader</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">method</span><span class="p">,</span> <span class="nx">credentials</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">credentials</span><span class="p">:</span> <span class="nx">credentials</span><span class="p">,</span>
        <span class="na">app</span><span class="p">:</span> <span class="nx">credentials</span><span class="p">.</span><span class="nx">app</span>
    <span class="p">};</span>
    <span class="k">return</span> <span class="nx">Hawk</span><span class="p">.</span><span class="nx">client</span><span class="p">.</span><span class="nx">header</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">method</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// example of an authorization header for '/v1/ticket' endpoint</span>
<span class="kd">let</span> <span class="nx">headers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">Authorization</span><span class="p">:</span> <span class="nx">getHawkHeader</span><span class="p">(</span><span class="s1">'https://api.getmyle.com/v1/ticket'</span><span class="p">,</span> <span class="s1">'POST'</span><span class="p">,</span> <span class="nx">myletCred</span><span class="p">).</span><span class="nx">field</span>
<span class="p">};</span>

<span class="c1">// example of an authorization header for `/v1/query` endpoint</span>
<span class="nx">headers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">Authorization</span><span class="p">:</span> <span class="nx">getHawkHeader</span><span class="p">(</span><span class="s1">'https://api.getmyle.com/v1/query'</span><span class="p">,</span> <span class="s1">'POST'</span><span class="p">,</span> <span class="nx">getUserTicket</span><span class="p">()).</span><span class="nx">field</span>
<span class="p">}</span>
</code></pre>

<p><code class="prettyprint">Authorization</code> header is required to be included with a request to MYLE API server. That is generated based on URL and method of the request as well as HAWK credentials specific to the request endpoint. The credentials are one of the two types:</p>

<ol>
<li><p>Mylet credentials</p>

<p>That is only required for <a href="#get-user-ticket"><code class="prettyprint">/v1/ticket</code> endpoint</a>. That consists of a mylet ID and a secret key. See example on the right.</p></li>
<li><p><a href="#user-ticket">User ticket</a></p>

<p>That is required for any other API endpoints.</p></li>
</ol>

<p><a href="https://github.com/hueniverse/hawk">Hawk</a> is used to generate an authorization request header. That is NodeJS library. Other platform <a href="https://github.com/hueniverse/hawk/blob/master/README.md#implementations">implementations</a> are also available:</p>

<ul>
<li><a href="https://github.com/logibit/logibit.hawk/">.NET - Logibit Hawk</a></li>
<li><a href="https://github.com/tent/hawk-ruby">Ruby - Tent Hawk</a></li>
<li><a href="https://github.com/wealdtech/hawk">Java - Wealdtech</a></li>
<li><a href="https://github.com/kumar303/mohawk/">Python - Kumar&rsquo;s Mohawk</a></li>
<li><a href="https://github.com/hiyosi/hawk">Go - Hiyosi</a></li>
<li><a href="https://github.com/dflydev/dflydev-hawk">PHP - Dflydev</a></li>
</ul>

          <h1 id="errors">Errors</h1>

<p>MYLE uses conventional HTTP response codes to indicate the success or failure of an API request. In general, codes in the 2xx range indicate success, codes in the 4xx range indicate an error that failed given the information provided (e.g., a required parameter was omitted, etc.), and codes in the 5xx range indicate an error with MYLE&rsquo;s servers.</p>

<h3 id="error-response-attributes">Error response attributes</h3>

<table><thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>statusCode</td>
<td>The HTTP status code (typically 4xx or 5xx)</td>
</tr>
<tr>
<td>error</td>
<td>The HTTP status message (e.g. <code class="prettyprint">Bad Request</code>, <code class="prettyprint">Internal Server Error</code>) derived from statusCode</td>
</tr>
<tr>
<td>message</td>
<td>The error message if specified</td>
</tr>
</tbody></table>

<h3 id="status-codes">Status codes</h3>

<table><thead>
<tr>
<th>Status Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>OK &ndash; Everything worked as expected</td>
</tr>
<tr>
<td>400</td>
<td>Bad Request &ndash; The request was unacceptable, often due to missing a required parameter</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized &ndash; <code class="prettyprint">Expired ticket</code>, <code class="prettyprint">Mismatching application id</code>, <code class="prettyprint">Invalid application</code>, <code class="prettyprint">Invalid grant</code></td>
</tr>
<tr>
<td>403</td>
<td>Forbidden &ndash; The request is authenticated but does not have the necessary permissions for the resource</td>
</tr>
<tr>
<td>404</td>
<td>Not Found &ndash;  The requested resource doesn&rsquo;t exist</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error &ndash; We had a problem with our server; try again later</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable &ndash; We&rsquo;re temporarially offline for maintanance; try again later</td>
</tr>
</tbody></table>

          <h1 id="ticket">Ticket</h1>

<h2 id="get-user-ticket">Get user ticket</h2>
<pre class="highlight javascript"><code><span class="kr">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'request'</span><span class="p">);</span>

<span class="kr">const</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">method</span><span class="p">:</span> <span class="s1">'POST'</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="s1">'https://api.getmyle.com/v1/ticket'</span><span class="p">,</span>
    <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">Authorization</span><span class="p">:</span> <span class="nx">getHawkHeader</span><span class="p">(</span><span class="s1">'https://api.getmyle.com/v1/ticket'</span><span class="p">,</span> <span class="s1">'POST'</span><span class="p">,</span> <span class="nx">getMyletCredentials</span><span class="p">()).</span><span class="nx">field</span>
    <span class="p">},</span>
    <span class="na">json</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">session</span><span class="p">:</span> <span class="nx">getSessionToken</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">request</span><span class="p">(</span><span class="nx">options</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">userTicket</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">userTicket</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>Request body structure</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
   </span><span class="nt">"session"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;SESSION&gt;"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Response body structure</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"exp"</span><span class="p">:</span><span class="w"> </span><span class="mi">1478832837390</span><span class="p">,</span><span class="w">
    </span><span class="nt">"app"</span><span class="p">:</span><span class="w"> </span><span class="s2">"com.example.mymylet"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"scope"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"mylet"</span><span class="p">],</span><span class="w">
    </span><span class="nt">"grant"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
    </span><span class="nt">"user"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-6b18XP5TDwlp9RxOhfZv4-5Zvm1n_LQ"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"algorithm"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sha256"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"ext"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"dbs"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2e2ed05a-4f63-4850-9297-5b8384397dd0"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;A TICKET IDENTIFIER&gt;"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint issues <a href="#user-ticket">a user ticket</a> for a given <a href="#session-token">session token</a>.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST https://api.getmyle.com/v1/ticket</code></p>

<h3 id="headers">Headers</h3>

<table><thead>
<tr>
<th>Header</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Authorization</td>
<td><a href="#authorization-header">The authorization header</a> generated by <a href="https://github.com/hueniverse/hawk">Hawk</a> using mylet credentials</td>
</tr>
</tbody></table>

<h3 id="request-body">Request body</h3>

<p><a href="#session-token">A session token</a> has to be sent. See example on the right.</p>

<h3 id="response-body">Response body</h3>

<p><a href="#user-ticket">A user ticket</a>.</p>

<h2 id="refresh-user-ticket">Refresh user ticket</h2>
<pre class="highlight javascript"><code><span class="kr">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'request'</span><span class="p">);</span>

<span class="kr">const</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">method</span><span class="p">:</span> <span class="s1">'POST'</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="s1">'https://api.getmyle.com/v1/ticket/reissue'</span><span class="p">,</span>
    <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">Authorization</span><span class="p">:</span> <span class="nx">getHawkHeader</span><span class="p">(</span><span class="s1">'https://api.getmyle.com/v1/ticket/reissue'</span><span class="p">,</span> <span class="s1">'POST'</span><span class="p">,</span> <span class="nx">getExistingUserTicket</span><span class="p">()).</span><span class="nx">field</span>
    <span class="p">},</span>
    <span class="na">json</span><span class="p">:</span> <span class="kc">true</span>
<span class="p">};</span>

<span class="nx">request</span><span class="p">(</span><span class="nx">options</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">newUserTicket</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">newUserTicket</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>Response body structure</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"exp"</span><span class="p">:</span><span class="w"> </span><span class="mi">1478832837390</span><span class="p">,</span><span class="w">
    </span><span class="nt">"app"</span><span class="p">:</span><span class="w"> </span><span class="s2">"com.example.mymylet"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"scope"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"mylet"</span><span class="p">],</span><span class="w">
    </span><span class="nt">"grant"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
    </span><span class="nt">"user"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-6b18XP5TDwlp9RxOhfZv4-5Zvm1n_LQ"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"algorithm"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sha256"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"ext"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"dbs"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2e2ed05a-4f63-4850-9297-5b8384397dd0"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;A TICKET IDENTIFIER&gt;"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint issues another <a href="#user-ticket">user ticket</a>.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST https://api.getmyle.com/v1/ticket/refresh</code></p>

<h3 id="headers">Headers</h3>

<table><thead>
<tr>
<th>Header</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Authorization</td>
<td><a href="#authorization-header">The authorization header</a> generated by <a href="https://github.com/hueniverse/hawk">Hawk</a> using an existing <a href="#user-ticket">user ticket</a>.</td>
</tr>
</tbody></table>

<h3 id="request-body">Request body</h3>

<p>Empty.</p>

<h3 id="response-body">Response body</h3>

<p><a href="#user-ticket">New user ticket</a>.</p>

          <h1 id="query">Query</h1>

<h2 id="execute-query">Execute query</h2>
<pre class="highlight javascript"><code><span class="kr">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'request'</span><span class="p">);</span>

<span class="kr">const</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">method</span><span class="p">:</span> <span class="s1">'POST'</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="s1">'https://api.getmyle.com/v1/query'</span><span class="p">,</span>
    <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">Authorization</span><span class="p">:</span> <span class="nx">getHawkHeader</span><span class="p">(</span><span class="s1">'https://api.getmyle.com/v1/query'</span><span class="p">,</span> <span class="s1">'POST'</span><span class="p">,</span> <span class="nx">getUserTicket</span><span class="p">()).</span><span class="nx">field</span>
    <span class="p">},</span>
    <span class="na">json</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">sets</span><span class="p">:</span> <span class="p">[</span><span class="s1">'master'</span><span class="p">],</span>
        <span class="na">take</span><span class="p">:</span> <span class="mi">1</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">request</span><span class="p">(</span><span class="nx">options</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">records</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">records</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>The above request returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3300"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"keyphrase"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-11-09T07:23:41.000Z"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"tzOffset"</span><span class="p">:</span><span class="w"> </span><span class="mi">-420</span><span class="p">,</span><span class="w">
    </span><span class="nt">"phrase"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Go to meeting tomorrow at 5 PM"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"language"</span><span class="p">:</span><span class="w"> </span><span class="s2">"eng-USA"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"longitude"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"latitude"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"altitude"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"isDeleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>

<p>This endpoint executes a query to user mylet records.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST https://api.getmyle.com/v1/query</code></p>

<h3 id="headers">Headers</h3>

<table><thead>
<tr>
<th>Header</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Authorization</td>
<td>The user ticket generated by <a href="#authorization-header">Hawk</a></td>
</tr>
</tbody></table>

<h3 id="request-body">Request body</h3>

<p>A <a href="#query-request">mylet query</a>.</p>

<h3 id="response-body">Response body</h3>

<p>A <a href="#query-response">mylet query response</a>.</p>

<h2 id="mylet-query">Mylet query</h2>

<blockquote>
<p>Example of a mylet query</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"sets"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"master"</span><span class="p">],</span><span class="w">
    </span><span class="nt">"where"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"time"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"$gte"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-11-11"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>A mylet query is used to query user records associated with a mylet. A mylet query is represented in JSON format.</p>

<h3 id="query-request">Query request</h3>

<p>Mylet query is a JSON with the folling properties:</p>

<table><thead>
<tr>
<th>Property</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>sets</td>
<td>true</td>
<td>A set to query from. Must be an array with a single <code class="prettyprint">master</code> element in it</td>
</tr>
<tr>
<td>select</td>
<td>optional</td>
<td>An array of <a href="#query-response">fields</a> to select. If not specified, <code class="prettyprint">id</code>, <code class="prettyprint">phrase</code> and <code class="prettyprint">time</code> are selected</td>
</tr>
<tr>
<td>where</td>
<td>optional</td>
<td>An object to filter resultset by, see <a href="#query-where-clause">Query <code class="prettyprint">where</code> clause</a> below</td>
</tr>
<tr>
<td>orderBy</td>
<td>optional</td>
<td>An array of <a href="#query-response">fields</a> to order by. To specify order direction explictly use <code class="prettyprint">{ &quot;$desc&quot;: &quot;field&quot; }</code> or <code class="prettyprint">{ &quot;$asc&quot;: &quot;field&quot; }</code> aray elements</td>
</tr>
<tr>
<td>skip</td>
<td>optional</td>
<td>Skips first number of records.</td>
</tr>
<tr>
<td>take</td>
<td>optional</td>
<td>Returns specified number of records. Defaults to <code class="prettyprint">100</code> if not specified. Fallbacks to <code class="prettyprint">100</code> if specified value is greater than <code class="prettyprint">100</code>.</td>
</tr>
</tbody></table>

<h3 id="query-where-clause">Query <code class="prettyprint">where</code> clause</h3>

<p>To specify equality condition, use the criteria <code class="prettyprint">{ &lt;field&gt;: &lt;value&gt; }</code> to select all records that contain the <code class="prettyprint">&lt;field&gt;</code> with the specified <code class="prettyprint">&lt;value&gt;</code>.</p>

<p>A criteria can use the property operators to specify a condition. For example, <code class="prettyprint">{ a: { $ne: 1 } }</code> selects all records where property <code class="prettyprint">a</code> not equal to <code class="prettyprint">1</code>.</p>

<p>A compound criteria can specify conditions for more than one field in a record. Implicitly, a logical <code class="prettyprint">AND</code> conjunction connects the clauses of a compound criteria so that the query selects the documents that match all the conditions. For example, <code class="prettyprint">{ a: 1, b: 2 }</code> selects all documents where <code class="prettyprint">a</code> equals to <code class="prettyprint">1</code> <strong>and</strong> <code class="prettyprint">b</code> equals to <code class="prettyprint">2</code>.</p>

<p>Using the <code class="prettyprint">$and</code>, <code class="prettyprint">$or</code> and <code class="prettyprint">$not</code> group operator, you can explicitly specify a compound criteria. For example, <code class="prettyprint">{ $or: [{ a: 1 }, { a: 2 }] }</code> selects all documents where property <code class="prettyprint">a</code> equals to <code class="prettyprint">1</code> or <code class="prettyprint">2</code>.</p>

<p>Supported group operators:</p>

<table><thead>
<tr>
<th>Operator</th>
<th>Meaning</th>
<th>Examples</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">$and</code></td>
<td>AND</td>
<td><code class="prettyprint">{ latitude: 4, longitude: 6 }</code> is equal to <code class="prettyprint">{ $and: { latitude: 4, longitude: 6 } }</code> and is equal to <code class="prettyprint">{ $and: [ { latitude: 4 }, { longitude: 6 } ] }</code> and means latitude equals 4 and longitude equals 6</td>
</tr>
<tr>
<td><code class="prettyprint">$or</code></td>
<td>OR</td>
<td><code class="prettyprint">{ $or: { latitude: 4, longitude: 6 } }</code> is equal to <code class="prettyprint">{ $or: [ { latitude: 4 }, { longitude: 6 } ] }</code> and means latitude equal 4 or longitude equals 6</td>
</tr>
<tr>
<td><code class="prettyprint">$not</code></td>
<td>negation</td>
<td><code class="prettyprint">{ $not: { latitude: 4 } }</code> means latitude not equal to 4; <code class="prettyprint">{ latitude: 4, { $not: { longitude: 6 } } }</code> means latitude equals 4 and longitude not equals to 6</td>
</tr>
</tbody></table>

<p>Supported property operators:</p>

<table><thead>
<tr>
<th>Operator</th>
<th>Meaning</th>
<th>Examples</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">$e</code></td>
<td>equals</td>
<td><code class="prettyprint">{ latitude: { $e: 4 } }</code> means latitude equals 4 and is the same as <code class="prettyprint">{ latitude: 4 }</code></td>
</tr>
<tr>
<td><code class="prettyprint">$ne</code></td>
<td>not equal to</td>
<td><code class="prettyprint">{ latitude: { $ne: 4 } }</code> means latitude not equal to 4</td>
</tr>
<tr>
<td><code class="prettyprint">$gte</code></td>
<td>greater than or equal to</td>
<td><code class="prettyprint">{ latitude: { $gte: 4 } }</code> means latitude is greater than or equal to 4</td>
</tr>
<tr>
<td><code class="prettyprint">$gt</code></td>
<td>greater than</td>
<td><code class="prettyprint">{ latitude: { $gte: 4 } }</code> means latitude is greater than 4</td>
</tr>
<tr>
<td><code class="prettyprint">$lte</code></td>
<td>less than or equal to</td>
<td><code class="prettyprint">{ latitude: { $lte: 4 } }</code> means latitude is less than or equal to 4</td>
</tr>
<tr>
<td><code class="prettyprint">$lt</code></td>
<td>less than</td>
<td><code class="prettyprint">{ latitude: { $lt: 4 } }</code> means latitude is less than 4</td>
</tr>
<tr>
<td><code class="prettyprint">$contains</code></td>
<td>string contains</td>
<td><code class="prettyprint">{ phrase: { $contains: &quot;test&quot; } }</code> means phrase contains &ldquo;test&rdquo; string. Applicable only to <code class="prettyprint">phrase</code> field</td>
</tr>
<tr>
<td><code class="prettyprint">$startsWith</code></td>
<td>string starts with</td>
<td><code class="prettyprint">{ phrase: { $startsWith: &quot;a&quot; } }</code> means phrase starts with &ldquo;a&rdquo; string. Applicable only to <code class="prettyprint">phrase</code> field</td>
</tr>
<tr>
<td><code class="prettyprint">$endsWith</code></td>
<td>string ends with</td>
<td><code class="prettyprint">{ phrase: { $endsWith: &quot;a&quot; } }</code> means phrase ends with &ldquo;a&rdquo; string. Applicable only to <code class="prettyprint">phrase</code> field</td>
</tr>
<tr>
<td><code class="prettyprint">$in</code></td>
<td>is in array</td>
<td><code class="prettyprint">{ altitude: { $in: [1, 2, 3, 4] } }</code> means altitude has value 1, 2, 3 or 4</td>
</tr>
</tbody></table>

<h3 id="query-response">Query response</h3>

<p>Result of a mylet query is an array of objects with the following properties:</p>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Record identifier</td>
</tr>
<tr>
<td>phrase</td>
<td>Record text</td>
</tr>
<tr>
<td>time</td>
<td>UTC time when a record was added</td>
</tr>
<tr>
<td>keyphrase</td>
<td>A keyphrase used for record association</td>
</tr>
<tr>
<td>tzOffset</td>
<td>User&rsquo;s timezone offset on records creation time</td>
</tr>
<tr>
<td>language</td>
<td>Language code used for recognition, for example, <code class="prettyprint">eng-USA</code></td>
</tr>
<tr>
<td>longitude</td>
<td>Longitude</td>
</tr>
<tr>
<td>latitude</td>
<td>Latitude</td>
</tr>
<tr>
<td>altitude</td>
<td>Altitude</td>
</tr>
<tr>
<td>isDeleted</td>
<td>Flag indicating whether association with a mylet was deleted or not</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="javascript">javascript</a>
          </div>
      </div>
    </div>
  </body>
</html>
